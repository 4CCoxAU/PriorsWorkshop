<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Part IV: Multi-level model with repeated measures | Workshop on Bayesian Data Analysis &amp; Priors</title>
  <meta name="description" content="This site is a hub for the materials for our workshop on Bayesian data analysis and priors." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Part IV: Multi-level model with repeated measures | Workshop on Bayesian Data Analysis &amp; Priors" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This site is a hub for the materials for our workshop on Bayesian data analysis and priors." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Part IV: Multi-level model with repeated measures | Workshop on Bayesian Data Analysis &amp; Priors" />
  
  <meta name="twitter:description" content="This site is a hub for the materials for our workshop on Bayesian data analysis and priors." />
  

<meta name="author" content="Riccardo Fusaroli &amp; Chris Cox" />


<meta name="date" content="2022-01-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="part-iii-linear-regression-with-a-dichotomous-predictor.html"/>
<link rel="next" href="part-v-multi-level-model-based-on-informed-priors.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Part I: Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#structure-of-this-workshop"><i class="fa fa-check"></i><b>1.1</b> Structure of this Workshop</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#link-to-introductory-video"><i class="fa fa-check"></i><b>1.2</b> Link to Introductory Video</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="part-ii-the-gaussian-intercepts-only-model.html"><a href="part-ii-the-gaussian-intercepts-only-model.html"><i class="fa fa-check"></i><b>2</b> Part II: The Gaussian intercepts-only model</a>
<ul>
<li class="chapter" data-level="2.1" data-path="part-ii-the-gaussian-intercepts-only-model.html"><a href="part-ii-the-gaussian-intercepts-only-model.html#part-i"><i class="fa fa-check"></i><b>2.1</b> PART I:</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="part-iii-linear-regression-with-a-dichotomous-predictor.html"><a href="part-iii-linear-regression-with-a-dichotomous-predictor.html"><i class="fa fa-check"></i><b>3</b> Part III: Linear regression with a dichotomous predictor</a></li>
<li class="chapter" data-level="4" data-path="part-iv-multi-level-model-with-repeated-measures.html"><a href="part-iv-multi-level-model-with-repeated-measures.html"><i class="fa fa-check"></i><b>4</b> Part IV: Multi-level model with repeated measures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="part-iv-multi-level-model-with-repeated-measures.html"><a href="part-iv-multi-level-model-with-repeated-measures.html#part-iv"><i class="fa fa-check"></i><b>4.1</b> PART IV:</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="part-v-multi-level-model-based-on-informed-priors.html"><a href="part-v-multi-level-model-based-on-informed-priors.html"><i class="fa fa-check"></i><b>5</b> Part V: Multi-level model based on informed priors</a>
<ul>
<li class="chapter" data-level="5.1" data-path="part-v-multi-level-model-based-on-informed-priors.html"><a href="part-v-multi-level-model-based-on-informed-priors.html#part-v"><i class="fa fa-check"></i><b>5.1</b> PART V:</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="recommendations-for-further-study.html"><a href="recommendations-for-further-study.html"><i class="fa fa-check"></i><b>6</b> Recommendations for Further Study</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop on Bayesian Data Analysis &amp; Priors</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="part-iv-multi-level-model-with-repeated-measures" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Part IV: Multi-level model with repeated measures</h1>
<div id="part-iv" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> PART IV:</h2>
<p>Let’s take our analysis to the next level (pun intended) by making a multi-level model with varying intercepts and varying slopes. In this model, we assign unique intercepts and slopes for each subject and assign them a common prior distribution. Let’s check which priors we need to specify for this model:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb47-1" aria-hidden="true" tabindex="-1"></a>Articulation_f3 <span class="ot">&lt;-</span> <span class="fu">bf</span>(ArticulationS <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Register <span class="sc">+</span> (<span class="dv">1</span><span class="sc">+</span>Register<span class="sc">|</span>Subject))</span>
<span id="cb47-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(Articulation_f3,</span>
<span id="cb47-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb47-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> d, </span>
<span id="cb47-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb47-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> gaussian)</span></code></pre></div>
<pre><code>##                    prior     class        coef   group resp dpar nlpar bound
##                   (flat)         b                                          
##                   (flat)         b RegisterIDS                              
##                   lkj(1)       cor                                          
##                   lkj(1)       cor             Subject                      
##  student_t(3, -0.4, 2.5) Intercept                                          
##     student_t(3, 0, 2.5)        sd                                          
##     student_t(3, 0, 2.5)        sd             Subject                      
##     student_t(3, 0, 2.5)        sd   Intercept Subject                      
##     student_t(3, 0, 2.5)        sd RegisterIDS Subject                      
##     student_t(3, 0, 2.5)     sigma                                          
##        source
##       default
##  (vectorized)
##       default
##  (vectorized)
##       default
##       default
##  (vectorized)
##  (vectorized)
##  (vectorized)
##       default</code></pre>
<p>The output of the above function tells us that we now have three sources of variation in the model: i) the usual standard deviation of the residuals (i.e., ‘sigma’), ii) the standard deviation of the population of by-subject varying intercepts (i.e., ‘Intercept’), and ii) the standard deviation of the population of by-subject varying slopes (i.e., ‘RegisterIDS’). The latter two sources of variation provide one of the most essential features of multi-level models: partial pooling, as we discussed in the lecture.</p>
<p>We are also told that we need to specify a prior for the correlation between the varying intercepts and the varying slopes (i.e. class = ‘cor’). This correlation captures the fact that we cannot assume the intercept and slope to be entirely independent. For example, caregivers who naturally produce a small vowel space in ADS can expand their vowel space when using IDS to a greater extent and may therefore show stronger effects.</p>
<p>We model the correlation between varying intercepts and slopes by using a so-called LKJ prior. The basic idea of the LKJ prior is that as its parameter increases, the prior favors less extreme correlations - that is, if we specify the LKJ parameter as 1, the prior represents a uniform, uninformative distribution (similar to that of a beta(1,1) distribution). If we set the parameter to 2, on the other hand, the prior serves to dampen the likelihood of extreme correlations, and we represent our lack of knowledge about the extent of correlation between the parameters. We’ll see what our prior(lkj(2), class = cor) looks like in the prior-posterior update plot below.</p>
<p>As usual, let’s start by performing a prior predictive check:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-1" aria-hidden="true" tabindex="-1"></a>Articulation_p3 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb49-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb49-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> Intercept, <span class="at">group =</span> Subject),</span>
<span id="cb49-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">class =</span> b),</span>
<span id="cb49-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> RegisterIDS, <span class="at">group =</span> Subject),</span>
<span id="cb49-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.5</span>), <span class="at">class =</span> sigma),</span>
<span id="cb49-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor))</span>
<span id="cb49-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-9" aria-hidden="true" tabindex="-1"></a>Articulation_m3_prior <span class="ot">&lt;-</span> </span>
<span id="cb49-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(</span>
<span id="cb49-11"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-11" aria-hidden="true" tabindex="-1"></a>    Articulation_f3,</span>
<span id="cb49-12"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> d,</span>
<span id="cb49-13"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-14"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> gaussian,</span>
<span id="cb49-15"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> Articulation_p3,</span>
<span id="cb49-16"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#file = &quot;Articulation_m3_prior&quot;,</span></span>
<span id="cb49-17"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_prior =</span> <span class="st">&quot;only&quot;</span>,</span>
<span id="cb49-18"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">5000</span>, </span>
<span id="cb49-19"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb49-20"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">2</span>,</span>
<span id="cb49-21"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb49-22"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb49-23"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">threads =</span> <span class="fu">threading</span>(<span class="dv">2</span>),</span>
<span id="cb49-24"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb49-25"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">adapt_delta =</span> <span class="fl">0.999</span>,</span>
<span id="cb49-26"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">max_treedepth =</span> <span class="dv">20</span>))</span>
<span id="cb49-27"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(Articulation_m3_prior, <span class="at">ndraws=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>After running the pp_check() function a couple of times, we should be convinced that our priors are within the order of magnitude that we expect. Great, let’s run the model on the actual data then:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-1" aria-hidden="true" tabindex="-1"></a>Articulation_m3 <span class="ot">&lt;-</span> </span>
<span id="cb50-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(</span>
<span id="cb50-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-3" aria-hidden="true" tabindex="-1"></a>    Articulation_f3,</span>
<span id="cb50-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> d,</span>
<span id="cb50-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb50-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> gaussian,</span>
<span id="cb50-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> Articulation_p3,</span>
<span id="cb50-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#file = &quot;Articulation_m3&quot;,</span></span>
<span id="cb50-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_prior =</span> T,</span>
<span id="cb50-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">5000</span>, </span>
<span id="cb50-11"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb50-12"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">2</span>,</span>
<span id="cb50-13"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb50-14"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb50-15"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">threads =</span> <span class="fu">threading</span>(<span class="dv">2</span>),</span>
<span id="cb50-16"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb50-17"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">adapt_delta =</span> <span class="fl">0.999</span>,</span>
<span id="cb50-18"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb50-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">max_treedepth =</span> <span class="dv">20</span>))</span></code></pre></div>
<p>As usual, let’s perform some posterior predictive checks to make sure that the model captures the data:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(Articulation_m3, <span class="at">ndraws=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>Everything looks great, so let’s plot the conditional effects and compare the output of the multi-level model with that of the previous constant-effect model:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(Articulation_m3), <span class="at">points =</span> T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary of the multi-level model:</span></span>
<span id="cb53-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Articulation_m3)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: ArticulationS ~ 1 + Register + (1 + Register | Subject) 
##    Data: d (Number of observations: 48) 
##   Draws: 2 chains, each with iter = 4000; warmup = 0; thin = 1;
##          total post-warmup draws = 8000
## 
## Group-Level Effects: 
## ~Subject (Number of levels: 24) 
##                            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
## sd(Intercept)                  0.42      0.24     0.03     0.91 1.00      981
## sd(RegisterIDS)                0.47      0.31     0.02     1.12 1.00      892
## cor(Intercept,RegisterIDS)    -0.04      0.43    -0.79     0.79 1.00     3220
##                            Tail_ESS
## sd(Intercept)                  1001
## sd(RegisterIDS)                 733
## cor(Intercept,RegisterIDS)     5085
## 
## Population-Level Effects: 
##             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept      -0.13      0.19    -0.50     0.24 1.00     6569     5557
## RegisterIDS    -0.39      0.21    -0.78     0.03 1.00     9691     6025
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.83      0.15     0.50     1.12 1.00      713      388
## 
## Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary of the constant-effect model:</span></span>
<span id="cb55-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Articulation_m2)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: ArticulationS ~ 1 + Register 
##    Data: d (Number of observations: 48) 
##   Draws: 2 chains, each with iter = 4000; warmup = 0; thin = 1;
##          total post-warmup draws = 8000
## 
## Population-Level Effects: 
##             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept      -0.15      0.18    -0.50     0.18 1.00     5984     4791
## RegisterIDS    -0.37      0.21    -0.78     0.04 1.00     6182     4747
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.98      0.10     0.80     1.21 1.00     5818     4892
## 
## Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Q5: What happens to the estimate for sigma (i.e. the residual variation) in this multi-level model? What does this indicate?</p>
<p>Answer:</p>
<hr />
<p>Let’s create some prior-posterior update plots so we can visualise how our model updates after seeing the data:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample the parameters of interest:</span></span>
<span id="cb57-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb57-2" aria-hidden="true" tabindex="-1"></a>Posterior_m3 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(Articulation_m3)</span>
<span id="cb57-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the prior-posterior update plot for the intercept:</span></span>
<span id="cb57-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Posterior_m3) <span class="sc">+</span></span>
<span id="cb57-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(prior_Intercept), <span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb57-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(b_Intercept), <span class="at">fill=</span><span class="st">&quot;#FC4E07&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb57-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Intercept&#39;</span>) <span class="sc">+</span></span>
<span id="cb57-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the prior-posterior update plot for b:</span></span>
<span id="cb58-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Posterior_m3) <span class="sc">+</span></span>
<span id="cb58-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(prior_b), <span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb58-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(b_RegisterIDS), <span class="at">fill=</span><span class="st">&quot;#FC4E07&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb58-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;b&#39;</span>) <span class="sc">+</span></span>
<span id="cb58-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-2.png" width="672" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the prior-posterior update plot for sd of intercepts and slopes:</span></span>
<span id="cb59-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Posterior_m3) <span class="sc">+</span></span>
<span id="cb59-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(sd_Subject__Intercept), <span class="at">fill=</span><span class="st">&quot;#FC4E07&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb59-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(sd_Subject__RegisterIDS), <span class="at">fill=</span><span class="st">&quot;#228B22&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.4</span>) <span class="sc">+</span> </span>
<span id="cb59-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(prior_sd_Subject__RegisterIDS), <span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb59-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;sd&#39;</span>) <span class="sc">+</span></span>
<span id="cb59-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-3.png" width="672" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the prior-posterior update plot for sigma:</span></span>
<span id="cb60-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Posterior_m3) <span class="sc">+</span></span>
<span id="cb60-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(prior_sigma), <span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb60-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(sigma), <span class="at">fill=</span><span class="st">&quot;#FC4E07&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb60-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;sigma&#39;</span>) <span class="sc">+</span></span>
<span id="cb60-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-4.png" width="672" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the prior-posterior update plot for the correlation between varying intercepts and slopes:</span></span>
<span id="cb61-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Posterior_m3) <span class="sc">+</span></span>
<span id="cb61-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(prior_cor_Subject), <span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb61-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(cor_Subject__Intercept__RegisterIDS), <span class="at">fill=</span><span class="st">&quot;#FC4E07&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb61-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;cor&#39;</span>) <span class="sc">+</span></span>
<span id="cb61-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-5.png" width="672" /></p>
<p>Let’s test our hypothesis with this model by using the hypothesis() function:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#overall</span></span>
<span id="cb62-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hypothesis</span>(Articulation_m3, <span class="st">&quot;RegisterIDS &lt; 0&quot;</span>)</span></code></pre></div>
<pre><code>## Hypothesis Tests for class b:
##          Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
## 1 (RegisterIDS) &lt; 0    -0.39      0.21    -0.72    -0.05      29.65      0.97
##   Star
## 1    *
## ---
## &#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
## &#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
## for two-sided hypotheses, the value tested against lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#for individual subjectss:</span></span>
<span id="cb64-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hypothesis</span>(Articulation_m3, <span class="st">&quot;RegisterIDS &lt; 0&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Subject&quot;</span>, <span class="at">scope=</span><span class="st">&quot;coef&quot;</span>)</span></code></pre></div>
<pre><code>## Hypothesis Tests for class :
##    Group        Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio
## 1     AF (RegisterIDS) &lt; 0     0.11      0.64    -0.70     1.36       1.07
## 2     AN (RegisterIDS) &lt; 0    -0.67      0.53    -1.65     0.07      13.84
## 3     CL (RegisterIDS) &lt; 0    -0.31      0.46    -1.01     0.52       3.62
## 4     DM (RegisterIDS) &lt; 0    -0.35      0.46    -1.08     0.44       4.13
## 5     IA (RegisterIDS) &lt; 0    -0.42      0.46    -1.20     0.34       5.38
## 6     JA (RegisterIDS) &lt; 0    -0.89      0.68    -2.28    -0.07      29.77
## 7     JE (RegisterIDS) &lt; 0    -0.43      0.45    -1.17     0.31       5.70
## 8     KA (RegisterIDS) &lt; 0    -0.52      0.47    -1.35     0.18       8.27
## 9     KV (RegisterIDS) &lt; 0    -0.54      0.48    -1.38     0.19       8.85
## 10    LK (RegisterIDS) &lt; 0    -0.66      0.54    -1.69     0.08      12.77
## 11    LM (RegisterIDS) &lt; 0    -0.28      0.46    -0.98     0.52       3.38
## 12    LV (RegisterIDS) &lt; 0    -0.29      0.47    -0.98     0.55       3.63
## 13    MA (RegisterIDS) &lt; 0    -0.38      0.51    -1.25     0.45       4.22
## 14    ME (RegisterIDS) &lt; 0    -0.53      0.47    -1.36     0.18       8.93
## 15   MPS (RegisterIDS) &lt; 0    -0.48      0.45    -1.24     0.23       7.82
## 16    MS (RegisterIDS) &lt; 0    -0.48      0.45    -1.26     0.23       7.21
## 17    MV (RegisterIDS) &lt; 0    -0.14      0.51    -0.83     0.84       2.07
## 18    PV (RegisterIDS) &lt; 0    -0.30      0.51    -1.10     0.57       3.26
## 19    RV (RegisterIDS) &lt; 0    -0.25      0.48    -0.97     0.63       2.92
## 20    SA (RegisterIDS) &lt; 0    -0.72      0.55    -1.77     0.02      16.54
## 21   SAF (RegisterIDS) &lt; 0    -0.40      0.46    -1.17     0.37       5.13
## 22    SC (RegisterIDS) &lt; 0    -0.36      0.45    -1.06     0.41       4.52
## 23    TL (RegisterIDS) &lt; 0    -0.78      0.59    -1.93    -0.04      23.17
## 24    TM (RegisterIDS) &lt; 0    -0.57      0.48    -1.46     0.12      11.10
##    Post.Prob Star
## 1       0.52     
## 2       0.93     
## 3       0.78     
## 4       0.81     
## 5       0.84     
## 6       0.97    *
## 7       0.85     
## 8       0.89     
## 9       0.90     
## 10      0.93     
## 11      0.77     
## 12      0.78     
## 13      0.81     
## 14      0.90     
## 15      0.89     
## 16      0.88     
## 17      0.67     
## 18      0.77     
## 19      0.75     
## 20      0.94     
## 21      0.84     
## 22      0.82     
## 23      0.96    *
## 24      0.92     
## ---
## &#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
## &#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
## for two-sided hypotheses, the value tested against lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<p>These results look interesting - however, we may be worried about the influence of our priors. Let’s conduct a prior robustness check for this multi-level model to calm our worries:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#code to loop through sd of intercept prior:</span></span>
<span id="cb66-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-2" aria-hidden="true" tabindex="-1"></a>priSD <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">1.5</span>, <span class="at">length.out =</span> <span class="dv">15</span>)</span>
<span id="cb66-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-3" aria-hidden="true" tabindex="-1"></a>priorsN <span class="ot">&lt;-</span> Articulation_p3</span>
<span id="cb66-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">#create empty sets to store output of the loop:</span></span>
<span id="cb66-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-5" aria-hidden="true" tabindex="-1"></a>post_pred <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb66-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-6" aria-hidden="true" tabindex="-1"></a>post_pred_lci <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb66-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-7" aria-hidden="true" tabindex="-1"></a>post_pred_uci <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb66-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(priSD)) {</span>
<span id="cb66-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-9" aria-hidden="true" tabindex="-1"></a>  priorsN[<span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">set_prior</span>(<span class="fu">paste0</span>(<span class="st">&quot;normal(0, &quot;</span>, priSD[i],<span class="st">&quot;)&quot;</span>), <span class="at">class =</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb66-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-10" aria-hidden="true" tabindex="-1"></a>  model_for_loop <span class="ot">&lt;-</span> <span class="fu">brm</span>(Articulation_f3,</span>
<span id="cb66-11"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">data   =</span> d, </span>
<span id="cb66-12"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-12" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">family =</span> gaussian, </span>
<span id="cb66-13"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-13" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">prior  =</span> priorsN, </span>
<span id="cb66-14"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-14" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sample_prior =</span> T,</span>
<span id="cb66-15"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-15" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">warmup =</span> <span class="dv">1000</span>, </span>
<span id="cb66-16"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-16" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">iter   =</span> <span class="dv">5000</span>, </span>
<span id="cb66-17"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-17" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">cores  =</span> <span class="dv">2</span>,</span>
<span id="cb66-18"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-18" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb66-19"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-19" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb66-20"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-20" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">threads =</span> <span class="fu">threading</span>(<span class="dv">2</span>),</span>
<span id="cb66-21"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-21" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb66-22"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-22" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta   =</span> <span class="fl">0.99</span>, </span>
<span id="cb66-23"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-23" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">max_treedepth =</span> <span class="dv">15</span>))</span>
<span id="cb66-24"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-25"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-25" aria-hidden="true" tabindex="-1"></a>  post_preds <span class="ot">&lt;-</span> <span class="fu">spread_draws</span>(model_for_loop, b_RegisterIDS)</span>
<span id="cb66-26"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-26" aria-hidden="true" tabindex="-1"></a>  post_pred[i] <span class="ot">&lt;-</span> <span class="fu">median</span>(post_preds<span class="sc">$</span>b_RegisterIDS)</span>
<span id="cb66-27"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-27" aria-hidden="true" tabindex="-1"></a>  post_pred_lci[i] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(post_preds<span class="sc">$</span>b_RegisterIDS, <span class="at">prob =</span> <span class="fl">0.025</span>)</span>
<span id="cb66-28"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-28" aria-hidden="true" tabindex="-1"></a>  post_pred_uci[i] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(post_preds<span class="sc">$</span>b_RegisterIDS, <span class="at">prob =</span> <span class="fl">0.975</span>)</span>
<span id="cb66-29"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-30"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-31"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-31" aria-hidden="true" tabindex="-1"></a>models_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(priSD, post_pred, post_pred_lci, post_pred_uci)</span>
<span id="cb66-32"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-33"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>models_data, <span class="fu">aes</span>(<span class="at">x=</span>priSD, <span class="at">y=</span>post_pred)) <span class="sc">+</span></span>
<span id="cb66-34"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb66-35"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">ymin =</span> post_pred_lci, <span class="at">ymax =</span> post_pred_uci) <span class="sc">+</span></span>
<span id="cb66-36"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb66-37"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Standard Deviation of Slope Prior&quot;</span>, </span>
<span id="cb66-38"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;Posterior Estimate for slope&quot;</span>, </span>
<span id="cb66-39"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Sensitivity analysis for multi-level model&quot;</span>) <span class="sc">+</span></span>
<span id="cb66-40"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb66-41"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb66-42"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb66-43"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb66-44"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb66-45"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb66-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>Q6: How does this prior robustness check compare to that of the model in Part 2?</p>
<p>Answer:</p>
<hr />
<p>BONUS CONTENT on how to plot partial pooling:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-1" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb67-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Subject =</span> <span class="fu">rownames</span>(<span class="fu">coef</span>(Articulation_m3)[[<span class="st">&quot;Subject&quot;</span>]][,,<span class="st">&quot;Intercept&quot;</span>]),</span>
<span id="cb67-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ADS =</span> <span class="fu">coef</span>(Articulation_m3)[[<span class="st">&quot;Subject&quot;</span>]][,,<span class="st">&quot;Intercept&quot;</span>][,<span class="dv">1</span>],</span>
<span id="cb67-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">IDS =</span> ADS <span class="sc">+</span> <span class="fu">coef</span>(Articulation_m3)[[<span class="st">&quot;Subject&quot;</span>]][,,<span class="st">&quot;RegisterIDS&quot;</span>][,<span class="dv">1</span>],</span>
<span id="cb67-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type =</span> <span class="st">&quot;partial pooling&quot;</span></span>
<span id="cb67-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(ADS<span class="sc">:</span>IDS) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb67-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Register =</span> name,</span>
<span id="cb67-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ArticulationS =</span> value</span>
<span id="cb67-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> d[, <span class="fu">c</span>(<span class="st">&quot;Subject&quot;</span>, <span class="st">&quot;Register&quot;</span>, <span class="st">&quot;ArticulationS&quot;</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb67-11"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">&quot;no pooling&quot;</span>)</span>
<span id="cb67-12"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-12" aria-hidden="true" tabindex="-1"></a>pool_df <span class="ot">&lt;-</span> df[,<span class="fu">c</span>(<span class="st">&quot;Subject&quot;</span>, <span class="st">&quot;Register&quot;</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb67-13"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb67-14"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ArticulationS =</span> <span class="fu">ifelse</span>(Register<span class="sc">==</span><span class="st">&quot;ADS&quot;</span>, <span class="fu">mean</span>(df<span class="sc">$</span>ArticulationS[df<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;ADS&quot;</span>]), <span class="fu">mean</span>(df<span class="sc">$</span>ArticulationS[df<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;IDS&quot;</span>])),</span>
<span id="cb67-15"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Type =</span> <span class="st">&quot;total pooling&quot;</span></span>
<span id="cb67-16"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb67-17"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-18"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-18" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(plot_df,df) </span>
<span id="cb67-19"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-20"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-20" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(plot_df,pool_df) </span>
<span id="cb67-21"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-22"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-22" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> plot_df <span class="sc">%&gt;%</span></span>
<span id="cb67-23"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Register=</span><span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(Register)))</span>
<span id="cb67-24"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-25"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(Register, ArticulationS, <span class="at">color =</span> Type)) <span class="sc">+</span> </span>
<span id="cb67-26"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb67-27"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb67-28"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>Subject) <span class="sc">+</span></span>
<span id="cb67-29"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb67-30"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb67-31"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb67-32"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb67-33"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb67-34"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb67-35"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">1.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>),</span>
<span id="cb67-36"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb67-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Now the ellipsis plot</span></span>
<span id="cb68-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Partial pooling</span></span>
<span id="cb68-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-3" aria-hidden="true" tabindex="-1"></a>df_partial <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb68-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Subject =</span> <span class="fu">rownames</span>(<span class="fu">coef</span>(Articulation_m3)[[<span class="st">&quot;Subject&quot;</span>]][,,<span class="st">&quot;Intercept&quot;</span>]),</span>
<span id="cb68-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ADS =</span> <span class="fu">coef</span>(Articulation_m3)[[<span class="st">&quot;Subject&quot;</span>]][,,<span class="st">&quot;Intercept&quot;</span>][,<span class="dv">1</span>],</span>
<span id="cb68-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">RegisterIDS =</span> <span class="fu">coef</span>(Articulation_m3)[[<span class="st">&quot;Subject&quot;</span>]][,,<span class="st">&quot;RegisterIDS&quot;</span>][,<span class="dv">1</span>],</span>
<span id="cb68-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type =</span> <span class="st">&quot;Partial pooling&quot;</span></span>
<span id="cb68-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Original data</span></span>
<span id="cb68-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-10" aria-hidden="true" tabindex="-1"></a>df_no <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb68-11"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="fu">unique</span>(d<span class="sc">$</span>Subject)){</span>
<span id="cb68-12"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-12" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb68-13"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Subject =</span> s,</span>
<span id="cb68-14"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ADS =</span> d<span class="sc">$</span>ArticulationS[d<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;ADS&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>Subject<span class="sc">==</span>s],</span>
<span id="cb68-15"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">RegisterIDS =</span> d<span class="sc">$</span>ArticulationS[d<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;IDS&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>Subject<span class="sc">==</span>s] <span class="sc">-</span> d<span class="sc">$</span>ArticulationS[d<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;ADS&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>Subject<span class="sc">==</span>s],</span>
<span id="cb68-16"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Type =</span> <span class="st">&quot;No pooling&quot;</span></span>
<span id="cb68-17"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-18"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;df_no&quot;</span>)){df_no <span class="ot">=</span> <span class="fu">rbind</span>(df_no, tmp)} <span class="cf">else</span> {df_no <span class="ot">=</span> tmp}</span>
<span id="cb68-19"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-20"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-20" aria-hidden="true" tabindex="-1"></a>df_total <span class="ot">&lt;-</span> df_no[,<span class="fu">c</span>(<span class="st">&quot;Subject&quot;</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb68-21"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-22"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ADS =</span> <span class="fu">mean</span>(d<span class="sc">$</span>ArticulationS[d<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;ADS&quot;</span>]),</span>
<span id="cb68-23"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">RegisterIDS =</span>  <span class="fu">mean</span>(d<span class="sc">$</span>ArticulationS[d<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;IDS&quot;</span>]) <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>ArticulationS[d<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;ADS&quot;</span>]),</span>
<span id="cb68-24"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Type =</span> <span class="st">&quot;Total pooling&quot;</span></span>
<span id="cb68-25"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-26"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-26" aria-hidden="true" tabindex="-1"></a>df_fixef <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb68-27"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type =</span> <span class="st">&quot;Partial pooling (average)&quot;</span>,</span>
<span id="cb68-28"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">ADS =</span> <span class="fu">fixef</span>(Articulation_m3)[<span class="dv">1</span>],</span>
<span id="cb68-29"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">RegisterIDS =</span> <span class="fu">fixef</span>(Articulation_m3)[<span class="dv">2</span>]</span>
<span id="cb68-30"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-31"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-32"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete pooling / fixed effects are center of gravity in the plot</span></span>
<span id="cb68-33"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-33" aria-hidden="true" tabindex="-1"></a>df_gravity <span class="ot">&lt;-</span> df_total <span class="sc">%&gt;%</span> </span>
<span id="cb68-34"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Type, ADS, RegisterIDS) <span class="sc">%&gt;%</span> </span>
<span id="cb68-35"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(df_fixef)</span>
<span id="cb68-36"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb68-36" aria-hidden="true" tabindex="-1"></a>df_gravity</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##         ADS RegisterIDS Type                     
##       &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;                    
## 1  1.83e-16      -0.691 Total pooling            
## 2 -1.26e- 1      -0.387 Partial pooling (average)</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb70-1" aria-hidden="true" tabindex="-1"></a>df_pulled <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df_no, df_partial)</span>
<span id="cb70-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the variance covariance matrix</span></span>
<span id="cb70-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb70-4" aria-hidden="true" tabindex="-1"></a>cov_mat_t <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(Articulation_m3)[[<span class="st">&quot;Subject&quot;</span>]]<span class="sc">$</span>cov</span>
<span id="cb70-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb70-5" aria-hidden="true" tabindex="-1"></a>cov_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb70-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb70-6" aria-hidden="true" tabindex="-1"></a>cov_mat[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span>cov_mat_t[,,<span class="st">&quot;Intercept&quot;</span>][<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb70-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb70-7" aria-hidden="true" tabindex="-1"></a>cov_mat[<span class="dv">2</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span>cov_mat_t[,,<span class="st">&quot;RegisterIDS&quot;</span>][<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb70-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb70-8" aria-hidden="true" tabindex="-1"></a>cov_mat[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span>cov_mat_t[,,<span class="st">&quot;Intercept&quot;</span>][<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb70-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb70-9" aria-hidden="true" tabindex="-1"></a>cov_mat[<span class="dv">2</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span>cov_mat_t[,,<span class="st">&quot;RegisterIDS&quot;</span>][<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb70-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb70-10" aria-hidden="true" tabindex="-1"></a>cov_mat</span></code></pre></div>
<pre><code>##             [,1]        [,2]
## [1,]  0.23098684 -0.03787621
## [2,] -0.03787621  0.30976748</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-1" aria-hidden="true" tabindex="-1"></a>make_ellipse <span class="ot">&lt;-</span> <span class="cf">function</span>(cov_mat, center, level) {</span>
<span id="cb72-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ellipse</span>(cov_mat, <span class="at">centre =</span> center, <span class="at">level =</span> level) <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">level =</span> level) <span class="sc">%&gt;%</span> </span>
<span id="cb72-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>()</span>
<span id="cb72-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-7" aria-hidden="true" tabindex="-1"></a>center <span class="ot">&lt;-</span> <span class="fu">fixef</span>(Articulation_m3)</span>
<span id="cb72-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-8" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">3</span>, .<span class="dv">5</span>, .<span class="dv">7</span>, .<span class="dv">9</span>)</span>
<span id="cb72-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an ellipse dataframe for each of the levels defined </span></span>
<span id="cb72-11"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co"># above and combine them</span></span>
<span id="cb72-12"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-12" aria-hidden="true" tabindex="-1"></a>df_ellipse <span class="ot">&lt;-</span> levels <span class="sc">%&gt;%</span></span>
<span id="cb72-13"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-13" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_df</span>(<span class="sc">~</span> <span class="fu">make_ellipse</span>(cov_mat, center, <span class="at">level =</span> .x)) <span class="sc">%&gt;%</span> </span>
<span id="cb72-14"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">ADS =</span> x, <span class="at">RegisterIDS =</span> y)</span>
<span id="cb72-15"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb72-15" aria-hidden="true" tabindex="-1"></a>df_ellipse</span></code></pre></div>
<pre><code>## # A tibble: 500 × 3
##         ADS RegisterIDS level
##       &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
##  1  0.0187       -0.220   0.1
##  2  0.00783      -0.208   0.1
##  3 -0.00357      -0.197   0.1
##  4 -0.0155       -0.186   0.1
##  5 -0.0278       -0.177   0.1
##  6 -0.0405       -0.168   0.1
##  7 -0.0536       -0.160   0.1
##  8 -0.0670       -0.153   0.1
##  9 -0.0806       -0.147   0.1
## 10 -0.0944       -0.142   0.1
## # … with 490 more rows</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-1" aria-hidden="true" tabindex="-1"></a>Gaussian_ellipsis <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_pulled) <span class="sc">+</span> </span>
<span id="cb74-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> ADS, <span class="at">y =</span> RegisterIDS, <span class="at">color =</span> Type) <span class="sc">+</span> </span>
<span id="cb74-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw contour lines from the distribution of effects</span></span>
<span id="cb74-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb74-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">group =</span> level, <span class="at">color =</span> <span class="cn">NULL</span>), </span>
<span id="cb74-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_ellipse, </span>
<span id="cb74-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb74-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;grey40&quot;</span></span>
<span id="cb74-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb74-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_gravity, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb74-11"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb74-12"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb74-13"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">group =</span> Subject, <span class="at">color =</span> <span class="cn">NULL</span>), </span>
<span id="cb74-14"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(.<span class="dv">02</span>, <span class="st">&quot;npc&quot;</span>))</span>
<span id="cb74-15"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb74-16"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use ggrepel to jitter the labels away from the points</span></span>
<span id="cb74-17"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-17" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb74-18"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> Subject, <span class="at">color =</span> <span class="cn">NULL</span>), </span>
<span id="cb74-19"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_no</span>
<span id="cb74-20"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb74-21"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Don&#39;t forget 373</span></span>
<span id="cb74-22"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-22" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb74-23"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> Subject, <span class="at">color =</span> <span class="cn">NULL</span>), </span>
<span id="cb74-24"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_partial</span>
<span id="cb74-25"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb74-26"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Topographic map of regression parameters&quot;</span>) <span class="sc">+</span> </span>
<span id="cb74-27"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Intercept estimate&quot;</span>) <span class="sc">+</span> </span>
<span id="cb74-28"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Slope estimate&quot;</span>) <span class="sc">+</span> </span>
<span id="cb74-29"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb74-30"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb74-31"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb74-32"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb74-33"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb74-34"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb74-35"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb74-36"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb74-37"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">1.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>))</span>
<span id="cb74-38"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-39"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb74-39" aria-hidden="true" tabindex="-1"></a>Gaussian_ellipsis</span></code></pre></div>
<pre><code>## Warning: ggrepel: 13 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>BONUS CONTENT on Student t:</p>
<p>One of the ways to allow for more flexibility in the distribution of the data would be to model the data using a student t likelihood. The main difference between the Gaussian and student t distribution is that a student t distribution with a low degrees of freedom parameter, nu, has heavier tails than the conventional Gaussian distribution. This form of model thus dampens the influence of outliers - incorporating outliers without allowing them to dominate non-outlier data. You can specify a student likelihood in the model using the ‘family’ parameter. As we can see in the results of the below get_prior() function, we now have to provide an additional prior for nu. For the following student t model, we will set the prior to be gamma(2, 0.1):</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb76-1" aria-hidden="true" tabindex="-1"></a>Articulation_f3 <span class="ot">&lt;-</span> <span class="fu">bf</span>(ArticulationS <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Register <span class="sc">+</span> (<span class="dv">1</span><span class="sc">+</span>Register<span class="sc">|</span>Subject))</span>
<span id="cb76-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(Articulation_f3, <span class="at">data =</span> d, <span class="at">family =</span> student)</span></code></pre></div>
<pre><code>##                    prior     class        coef   group resp dpar nlpar bound
##                   (flat)         b                                          
##                   (flat)         b RegisterIDS                              
##                   lkj(1)       cor                                          
##                   lkj(1)       cor             Subject                      
##  student_t(3, -0.4, 2.5) Intercept                                          
##            gamma(2, 0.1)        nu                                          
##     student_t(3, 0, 2.5)        sd                                          
##     student_t(3, 0, 2.5)        sd             Subject                      
##     student_t(3, 0, 2.5)        sd   Intercept Subject                      
##     student_t(3, 0, 2.5)        sd RegisterIDS Subject                      
##     student_t(3, 0, 2.5)     sigma                                          
##        source
##       default
##  (vectorized)
##       default
##  (vectorized)
##       default
##       default
##       default
##  (vectorized)
##  (vectorized)
##  (vectorized)
##       default</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-1" aria-hidden="true" tabindex="-1"></a>student_priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb78-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb78-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> Intercept, <span class="at">group =</span> Subject),</span>
<span id="cb78-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">class =</span> b),</span>
<span id="cb78-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sd, <span class="at">coef =</span> RegisterIDS, <span class="at">group =</span> Subject),</span>
<span id="cb78-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">1</span>, <span class="fl">0.5</span>), <span class="at">class =</span> sigma),</span>
<span id="cb78-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor),</span>
<span id="cb78-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">gamma</span>(<span class="dv">2</span>, <span class="fl">0.1</span>), <span class="at">class =</span> nu))</span>
<span id="cb78-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-10" aria-hidden="true" tabindex="-1"></a>Articulation_student_m3 <span class="ot">&lt;-</span> </span>
<span id="cb78-11"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(</span>
<span id="cb78-12"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-12" aria-hidden="true" tabindex="-1"></a>    Articulation_f3,</span>
<span id="cb78-13"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> d,</span>
<span id="cb78-14"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb78-15"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> student,</span>
<span id="cb78-16"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior =</span> student_priors,</span>
<span id="cb78-17"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#file = &quot;Articulation_student_m3&quot;,</span></span>
<span id="cb78-18"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample_prior =</span> T,</span>
<span id="cb78-19"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="dv">10000</span>, </span>
<span id="cb78-20"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb78-21"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> <span class="dv">2</span>,</span>
<span id="cb78-22"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb78-23"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">backend =</span> <span class="st">&quot;cmdstanr&quot;</span>,</span>
<span id="cb78-24"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">threads =</span> <span class="fu">threading</span>(<span class="dv">2</span>),</span>
<span id="cb78-25"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb78-26"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">adapt_delta =</span> <span class="fl">0.999</span>,</span>
<span id="cb78-27"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb78-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">max_treedepth =</span> <span class="dv">20</span>))</span></code></pre></div>
<pre><code>## Compiling Stan program...</code></pre>
<pre><code>## Start sampling</code></pre>
<pre><code>## Running MCMC with 2 parallel chains, with 2 thread(s) per chain...
## 
## Chain 1 Iteration:    1 / 10000 [  0%]  (Warmup) 
## Chain 2 Iteration:    1 / 10000 [  0%]  (Warmup) 
## Chain 2 Iteration:  100 / 10000 [  1%]  (Warmup) 
## Chain 1 Iteration:  100 / 10000 [  1%]  (Warmup) 
## Chain 2 Iteration:  200 / 10000 [  2%]  (Warmup) 
## Chain 1 Iteration:  200 / 10000 [  2%]  (Warmup) 
## Chain 2 Iteration:  300 / 10000 [  3%]  (Warmup) 
## Chain 1 Iteration:  300 / 10000 [  3%]  (Warmup) 
## Chain 2 Iteration:  400 / 10000 [  4%]  (Warmup) 
## Chain 1 Iteration:  400 / 10000 [  4%]  (Warmup) 
## Chain 2 Iteration:  500 / 10000 [  5%]  (Warmup) 
## Chain 1 Iteration:  500 / 10000 [  5%]  (Warmup) 
## Chain 1 Iteration:  600 / 10000 [  6%]  (Warmup) 
## Chain 2 Iteration:  600 / 10000 [  6%]  (Warmup) 
## Chain 1 Iteration:  700 / 10000 [  7%]  (Warmup) 
## Chain 2 Iteration:  700 / 10000 [  7%]  (Warmup) 
## Chain 1 Iteration:  800 / 10000 [  8%]  (Warmup) 
## Chain 2 Iteration:  800 / 10000 [  8%]  (Warmup) 
## Chain 1 Iteration:  900 / 10000 [  9%]  (Warmup) 
## Chain 2 Iteration:  900 / 10000 [  9%]  (Warmup) 
## Chain 1 Iteration: 1000 / 10000 [ 10%]  (Warmup) 
## Chain 1 Iteration: 1001 / 10000 [ 10%]  (Sampling) 
## Chain 2 Iteration: 1000 / 10000 [ 10%]  (Warmup) 
## Chain 2 Iteration: 1001 / 10000 [ 10%]  (Sampling) 
## Chain 1 Iteration: 1100 / 10000 [ 11%]  (Sampling) 
## Chain 1 Iteration: 1200 / 10000 [ 12%]  (Sampling) 
## Chain 2 Iteration: 1100 / 10000 [ 11%]  (Sampling) 
## Chain 1 Iteration: 1300 / 10000 [ 13%]  (Sampling) 
## Chain 1 Iteration: 1400 / 10000 [ 14%]  (Sampling) 
## Chain 2 Iteration: 1200 / 10000 [ 12%]  (Sampling) 
## Chain 1 Iteration: 1500 / 10000 [ 15%]  (Sampling) 
## Chain 1 Iteration: 1600 / 10000 [ 16%]  (Sampling) 
## Chain 2 Iteration: 1300 / 10000 [ 13%]  (Sampling) 
## Chain 1 Iteration: 1700 / 10000 [ 17%]  (Sampling) 
## Chain 2 Iteration: 1400 / 10000 [ 14%]  (Sampling) 
## Chain 1 Iteration: 1800 / 10000 [ 18%]  (Sampling) 
## Chain 1 Iteration: 1900 / 10000 [ 19%]  (Sampling) 
## Chain 2 Iteration: 1500 / 10000 [ 15%]  (Sampling) 
## Chain 1 Iteration: 2000 / 10000 [ 20%]  (Sampling) 
## Chain 1 Iteration: 2100 / 10000 [ 21%]  (Sampling) 
## Chain 2 Iteration: 1600 / 10000 [ 16%]  (Sampling) 
## Chain 1 Iteration: 2200 / 10000 [ 22%]  (Sampling) 
## Chain 1 Iteration: 2300 / 10000 [ 23%]  (Sampling) 
## Chain 2 Iteration: 1700 / 10000 [ 17%]  (Sampling) 
## Chain 1 Iteration: 2400 / 10000 [ 24%]  (Sampling) 
## Chain 1 Iteration: 2500 / 10000 [ 25%]  (Sampling) 
## Chain 2 Iteration: 1800 / 10000 [ 18%]  (Sampling) 
## Chain 1 Iteration: 2600 / 10000 [ 26%]  (Sampling) 
## Chain 1 Iteration: 2700 / 10000 [ 27%]  (Sampling) 
## Chain 2 Iteration: 1900 / 10000 [ 19%]  (Sampling) 
## Chain 1 Iteration: 2800 / 10000 [ 28%]  (Sampling) 
## Chain 2 Iteration: 2000 / 10000 [ 20%]  (Sampling) 
## Chain 1 Iteration: 2900 / 10000 [ 29%]  (Sampling) 
## Chain 1 Iteration: 3000 / 10000 [ 30%]  (Sampling) 
## Chain 2 Iteration: 2100 / 10000 [ 21%]  (Sampling) 
## Chain 1 Iteration: 3100 / 10000 [ 31%]  (Sampling) 
## Chain 1 Iteration: 3200 / 10000 [ 32%]  (Sampling) 
## Chain 2 Iteration: 2200 / 10000 [ 22%]  (Sampling) 
## Chain 1 Iteration: 3300 / 10000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 3400 / 10000 [ 34%]  (Sampling) 
## Chain 2 Iteration: 2300 / 10000 [ 23%]  (Sampling) 
## Chain 1 Iteration: 3500 / 10000 [ 35%]  (Sampling) 
## Chain 1 Iteration: 3600 / 10000 [ 36%]  (Sampling) 
## Chain 2 Iteration: 2400 / 10000 [ 24%]  (Sampling) 
## Chain 1 Iteration: 3700 / 10000 [ 37%]  (Sampling) 
## Chain 1 Iteration: 3800 / 10000 [ 38%]  (Sampling) 
## Chain 2 Iteration: 2500 / 10000 [ 25%]  (Sampling) 
## Chain 1 Iteration: 3900 / 10000 [ 39%]  (Sampling) 
## Chain 1 Iteration: 4000 / 10000 [ 40%]  (Sampling) 
## Chain 2 Iteration: 2600 / 10000 [ 26%]  (Sampling) 
## Chain 1 Iteration: 4100 / 10000 [ 41%]  (Sampling) 
## Chain 2 Iteration: 2700 / 10000 [ 27%]  (Sampling) 
## Chain 1 Iteration: 4200 / 10000 [ 42%]  (Sampling) 
## Chain 1 Iteration: 4300 / 10000 [ 43%]  (Sampling) 
## Chain 2 Iteration: 2800 / 10000 [ 28%]  (Sampling) 
## Chain 1 Iteration: 4400 / 10000 [ 44%]  (Sampling) 
## Chain 1 Iteration: 4500 / 10000 [ 45%]  (Sampling) 
## Chain 2 Iteration: 2900 / 10000 [ 29%]  (Sampling) 
## Chain 1 Iteration: 4600 / 10000 [ 46%]  (Sampling) 
## Chain 1 Iteration: 4700 / 10000 [ 47%]  (Sampling) 
## Chain 2 Iteration: 3000 / 10000 [ 30%]  (Sampling) 
## Chain 1 Iteration: 4800 / 10000 [ 48%]  (Sampling) 
## Chain 1 Iteration: 4900 / 10000 [ 49%]  (Sampling) 
## Chain 2 Iteration: 3100 / 10000 [ 31%]  (Sampling) 
## Chain 1 Iteration: 5000 / 10000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 5100 / 10000 [ 51%]  (Sampling) 
## Chain 2 Iteration: 3200 / 10000 [ 32%]  (Sampling) 
## Chain 1 Iteration: 5200 / 10000 [ 52%]  (Sampling) 
## Chain 1 Iteration: 5300 / 10000 [ 53%]  (Sampling) 
## Chain 2 Iteration: 3300 / 10000 [ 33%]  (Sampling) 
## Chain 1 Iteration: 5400 / 10000 [ 54%]  (Sampling) 
## Chain 2 Iteration: 3400 / 10000 [ 34%]  (Sampling) 
## Chain 1 Iteration: 5500 / 10000 [ 55%]  (Sampling) 
## Chain 1 Iteration: 5600 / 10000 [ 56%]  (Sampling) 
## Chain 2 Iteration: 3500 / 10000 [ 35%]  (Sampling) 
## Chain 1 Iteration: 5700 / 10000 [ 57%]  (Sampling) 
## Chain 1 Iteration: 5800 / 10000 [ 58%]  (Sampling) 
## Chain 2 Iteration: 3600 / 10000 [ 36%]  (Sampling) 
## Chain 1 Iteration: 5900 / 10000 [ 59%]  (Sampling) 
## Chain 1 Iteration: 6000 / 10000 [ 60%]  (Sampling) 
## Chain 2 Iteration: 3700 / 10000 [ 37%]  (Sampling) 
## Chain 1 Iteration: 6100 / 10000 [ 61%]  (Sampling) 
## Chain 2 Iteration: 3800 / 10000 [ 38%]  (Sampling) 
## Chain 1 Iteration: 6200 / 10000 [ 62%]  (Sampling) 
## Chain 1 Iteration: 6300 / 10000 [ 63%]  (Sampling) 
## Chain 2 Iteration: 3900 / 10000 [ 39%]  (Sampling) 
## Chain 1 Iteration: 6400 / 10000 [ 64%]  (Sampling) 
## Chain 1 Iteration: 6500 / 10000 [ 65%]  (Sampling) 
## Chain 2 Iteration: 4000 / 10000 [ 40%]  (Sampling) 
## Chain 1 Iteration: 6600 / 10000 [ 66%]  (Sampling) 
## Chain 1 Iteration: 6700 / 10000 [ 67%]  (Sampling) 
## Chain 2 Iteration: 4100 / 10000 [ 41%]  (Sampling) 
## Chain 1 Iteration: 6800 / 10000 [ 68%]  (Sampling) 
## Chain 1 Iteration: 6900 / 10000 [ 69%]  (Sampling) 
## Chain 2 Iteration: 4200 / 10000 [ 42%]  (Sampling) 
## Chain 1 Iteration: 7000 / 10000 [ 70%]  (Sampling) 
## Chain 1 Iteration: 7100 / 10000 [ 71%]  (Sampling) 
## Chain 2 Iteration: 4300 / 10000 [ 43%]  (Sampling) 
## Chain 1 Iteration: 7200 / 10000 [ 72%]  (Sampling) 
## Chain 1 Iteration: 7300 / 10000 [ 73%]  (Sampling) 
## Chain 2 Iteration: 4400 / 10000 [ 44%]  (Sampling) 
## Chain 1 Iteration: 7400 / 10000 [ 74%]  (Sampling) 
## Chain 1 Iteration: 7500 / 10000 [ 75%]  (Sampling) 
## Chain 2 Iteration: 4500 / 10000 [ 45%]  (Sampling) 
## Chain 1 Iteration: 7600 / 10000 [ 76%]  (Sampling) 
## Chain 2 Iteration: 4600 / 10000 [ 46%]  (Sampling) 
## Chain 1 Iteration: 7700 / 10000 [ 77%]  (Sampling) 
## Chain 1 Iteration: 7800 / 10000 [ 78%]  (Sampling) 
## Chain 2 Iteration: 4700 / 10000 [ 47%]  (Sampling) 
## Chain 1 Iteration: 7900 / 10000 [ 79%]  (Sampling) 
## Chain 1 Iteration: 8000 / 10000 [ 80%]  (Sampling) 
## Chain 2 Iteration: 4800 / 10000 [ 48%]  (Sampling) 
## Chain 1 Iteration: 8100 / 10000 [ 81%]  (Sampling) 
## Chain 2 Iteration: 4900 / 10000 [ 49%]  (Sampling) 
## Chain 1 Iteration: 8200 / 10000 [ 82%]  (Sampling) 
## Chain 1 Iteration: 8300 / 10000 [ 83%]  (Sampling) 
## Chain 2 Iteration: 5000 / 10000 [ 50%]  (Sampling) 
## Chain 1 Iteration: 8400 / 10000 [ 84%]  (Sampling) 
## Chain 1 Iteration: 8500 / 10000 [ 85%]  (Sampling) 
## Chain 2 Iteration: 5100 / 10000 [ 51%]  (Sampling) 
## Chain 1 Iteration: 8600 / 10000 [ 86%]  (Sampling) 
## Chain 1 Iteration: 8700 / 10000 [ 87%]  (Sampling) 
## Chain 2 Iteration: 5200 / 10000 [ 52%]  (Sampling) 
## Chain 1 Iteration: 8800 / 10000 [ 88%]  (Sampling) 
## Chain 1 Iteration: 8900 / 10000 [ 89%]  (Sampling) 
## Chain 2 Iteration: 5300 / 10000 [ 53%]  (Sampling) 
## Chain 1 Iteration: 9000 / 10000 [ 90%]  (Sampling) 
## Chain 1 Iteration: 9100 / 10000 [ 91%]  (Sampling) 
## Chain 2 Iteration: 5400 / 10000 [ 54%]  (Sampling) 
## Chain 1 Iteration: 9200 / 10000 [ 92%]  (Sampling) 
## Chain 1 Iteration: 9300 / 10000 [ 93%]  (Sampling) 
## Chain 2 Iteration: 5500 / 10000 [ 55%]  (Sampling) 
## Chain 1 Iteration: 9400 / 10000 [ 94%]  (Sampling) 
## Chain 1 Iteration: 9500 / 10000 [ 95%]  (Sampling) 
## Chain 2 Iteration: 5600 / 10000 [ 56%]  (Sampling) 
## Chain 1 Iteration: 9600 / 10000 [ 96%]  (Sampling) 
## Chain 2 Iteration: 5700 / 10000 [ 57%]  (Sampling) 
## Chain 1 Iteration: 9700 / 10000 [ 97%]  (Sampling) 
## Chain 1 Iteration: 9800 / 10000 [ 98%]  (Sampling) 
## Chain 1 Iteration: 9900 / 10000 [ 99%]  (Sampling) 
## Chain 2 Iteration: 5800 / 10000 [ 58%]  (Sampling) 
## Chain 1 Iteration: 10000 / 10000 [100%]  (Sampling) 
## Chain 1 finished in 31.6 seconds.
## Chain 2 Iteration: 5900 / 10000 [ 59%]  (Sampling) 
## Chain 2 Iteration: 6000 / 10000 [ 60%]  (Sampling) 
## Chain 2 Iteration: 6100 / 10000 [ 61%]  (Sampling) 
## Chain 2 Iteration: 6200 / 10000 [ 62%]  (Sampling) 
## Chain 2 Iteration: 6300 / 10000 [ 63%]  (Sampling) 
## Chain 2 Iteration: 6400 / 10000 [ 64%]  (Sampling) 
## Chain 2 Iteration: 6500 / 10000 [ 65%]  (Sampling) 
## Chain 2 Iteration: 6600 / 10000 [ 66%]  (Sampling) 
## Chain 2 Iteration: 6700 / 10000 [ 67%]  (Sampling) 
## Chain 2 Iteration: 6800 / 10000 [ 68%]  (Sampling) 
## Chain 2 Iteration: 6900 / 10000 [ 69%]  (Sampling) 
## Chain 2 Iteration: 7000 / 10000 [ 70%]  (Sampling) 
## Chain 2 Iteration: 7100 / 10000 [ 71%]  (Sampling) 
## Chain 2 Iteration: 7200 / 10000 [ 72%]  (Sampling) 
## Chain 2 Iteration: 7300 / 10000 [ 73%]  (Sampling) 
## Chain 2 Iteration: 7400 / 10000 [ 74%]  (Sampling) 
## Chain 2 Iteration: 7500 / 10000 [ 75%]  (Sampling) 
## Chain 2 Iteration: 7600 / 10000 [ 76%]  (Sampling) 
## Chain 2 Iteration: 7700 / 10000 [ 77%]  (Sampling) 
## Chain 2 Iteration: 7800 / 10000 [ 78%]  (Sampling) 
## Chain 2 Iteration: 7900 / 10000 [ 79%]  (Sampling) 
## Chain 2 Iteration: 8000 / 10000 [ 80%]  (Sampling) 
## Chain 2 Iteration: 8100 / 10000 [ 81%]  (Sampling) 
## Chain 2 Iteration: 8200 / 10000 [ 82%]  (Sampling) 
## Chain 2 Iteration: 8300 / 10000 [ 83%]  (Sampling) 
## Chain 2 Iteration: 8400 / 10000 [ 84%]  (Sampling) 
## Chain 2 Iteration: 8500 / 10000 [ 85%]  (Sampling) 
## Chain 2 Iteration: 8600 / 10000 [ 86%]  (Sampling) 
## Chain 2 Iteration: 8700 / 10000 [ 87%]  (Sampling) 
## Chain 2 Iteration: 8800 / 10000 [ 88%]  (Sampling) 
## Chain 2 Iteration: 8900 / 10000 [ 89%]  (Sampling) 
## Chain 2 Iteration: 9000 / 10000 [ 90%]  (Sampling) 
## Chain 2 Iteration: 9100 / 10000 [ 91%]  (Sampling) 
## Chain 2 Iteration: 9200 / 10000 [ 92%]  (Sampling) 
## Chain 2 Iteration: 9300 / 10000 [ 93%]  (Sampling) 
## Chain 2 Iteration: 9400 / 10000 [ 94%]  (Sampling) 
## Chain 2 Iteration: 9500 / 10000 [ 95%]  (Sampling) 
## Chain 2 Iteration: 9600 / 10000 [ 96%]  (Sampling) 
## Chain 2 Iteration: 9700 / 10000 [ 97%]  (Sampling) 
## Chain 2 Iteration: 9800 / 10000 [ 98%]  (Sampling) 
## Chain 2 Iteration: 9900 / 10000 [ 99%]  (Sampling) 
## Chain 2 Iteration: 10000 / 10000 [100%]  (Sampling) 
## Chain 2 finished in 54.5 seconds.
## 
## Both chains finished successfully.
## Mean chain execution time: 43.0 seconds.
## Total execution time: 54.9 seconds.</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Articulation_student_m3)</span></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = identity; nu = identity 
## Formula: ArticulationS ~ 1 + Register + (1 + Register | Subject) 
##    Data: d (Number of observations: 48) 
##   Draws: 2 chains, each with iter = 9000; warmup = 0; thin = 1;
##          total post-warmup draws = 18000
## 
## Group-Level Effects: 
## ~Subject (Number of levels: 24) 
##                            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
## sd(Intercept)                  0.42      0.24     0.03     0.90 1.00     2719
## sd(RegisterIDS)                0.45      0.30     0.02     1.12 1.00     2634
## cor(Intercept,RegisterIDS)    -0.06      0.43    -0.80     0.79 1.00    10781
##                            Tail_ESS
## sd(Intercept)                  3668
## sd(RegisterIDS)                2582
## cor(Intercept,RegisterIDS)    12030
## 
## Population-Level Effects: 
##             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept      -0.13      0.18    -0.49     0.22 1.00    16180    13178
## RegisterIDS    -0.39      0.21    -0.79     0.03 1.00    20494    13017
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.79      0.15     0.46     1.08 1.00     2056     1127
## nu       22.52     13.99     4.94    57.82 1.00    18367    11500
## 
## Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">conditional_effects</span>(Articulation_student_m3), <span class="at">points =</span> T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>Let’s check the prior-posterior update plots for the student t model:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample the parameters of interest:</span></span>
<span id="cb85-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb85-2" aria-hidden="true" tabindex="-1"></a>Posterior_student_m3 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(Articulation_student_m3)</span>
<span id="cb85-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the prior-posterior update plot for the intercept:</span></span>
<span id="cb85-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Posterior_student_m3) <span class="sc">+</span></span>
<span id="cb85-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(prior_Intercept), <span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb85-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(b_Intercept), <span class="at">fill=</span><span class="st">&quot;#FC4E07&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb85-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Intercept&#39;</span>) <span class="sc">+</span></span>
<span id="cb85-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the prior-posterior update plot for b:</span></span>
<span id="cb86-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Posterior_student_m3) <span class="sc">+</span></span>
<span id="cb86-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(prior_b), <span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb86-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(b_RegisterIDS), <span class="at">fill=</span><span class="st">&quot;#FC4E07&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb86-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;b&#39;</span>) <span class="sc">+</span></span>
<span id="cb86-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-2.png" width="672" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the prior-posterior update plot for sd of intercepts and slopes:</span></span>
<span id="cb87-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Posterior_student_m3) <span class="sc">+</span></span>
<span id="cb87-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(sd_Subject__Intercept), <span class="at">fill=</span><span class="st">&quot;#FC4E07&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb87-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(sd_Subject__RegisterIDS), <span class="at">fill=</span><span class="st">&quot;#228B22&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.4</span>) <span class="sc">+</span> </span>
<span id="cb87-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(prior_sd_Subject__RegisterIDS), <span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb87-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;sd&#39;</span>) <span class="sc">+</span></span>
<span id="cb87-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-3.png" width="672" /></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the prior-posterior update plot for sigma:</span></span>
<span id="cb88-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Posterior_student_m3) <span class="sc">+</span></span>
<span id="cb88-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(prior_sigma), <span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb88-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(sigma), <span class="at">fill=</span><span class="st">&quot;#FC4E07&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb88-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;sigma&#39;</span>) <span class="sc">+</span></span>
<span id="cb88-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-4.png" width="672" /></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the prior-posterior update plot for the correlation between varying intercepts and slopes:</span></span>
<span id="cb89-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Posterior_student_m3) <span class="sc">+</span></span>
<span id="cb89-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(prior_cor_Subject), <span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb89-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(cor_Subject__Intercept__RegisterIDS), <span class="at">fill=</span><span class="st">&quot;#FC4E07&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb89-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;cor&#39;</span>) <span class="sc">+</span></span>
<span id="cb89-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-5.png" width="672" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the prior-posterior update plot for the correlation between varying intercepts and slopes:</span></span>
<span id="cb90-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Posterior_student_m3) <span class="sc">+</span></span>
<span id="cb90-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(prior_nu), <span class="at">fill=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb90-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(nu), <span class="at">fill=</span><span class="st">&quot;#FC4E07&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb90-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;nu&#39;</span>) <span class="sc">+</span></span>
<span id="cb90-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-6.png" width="672" /></p>
<p>How do the estimates and evidence ratio of the student model compare to that of the Gaussian model?</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#hypothesis check for Gaussian model:</span></span>
<span id="cb91-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hypothesis</span>(Articulation_m3, <span class="st">&quot;RegisterIDS &lt; 0&quot;</span>)</span></code></pre></div>
<pre><code>## Hypothesis Tests for class b:
##          Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
## 1 (RegisterIDS) &lt; 0    -0.39      0.21    -0.72    -0.05      29.65      0.97
##   Star
## 1    *
## ---
## &#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
## &#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
## for two-sided hypotheses, the value tested against lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#hypothesis check for student t model:</span></span>
<span id="cb93-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hypothesis</span>(Articulation_student_m3, <span class="st">&quot;RegisterIDS &lt; 0&quot;</span>)</span></code></pre></div>
<pre><code>## Hypothesis Tests for class b:
##          Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
## 1 (RegisterIDS) &lt; 0    -0.39      0.21    -0.72    -0.04       29.2      0.97
##   Star
## 1    *
## ---
## &#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
## &#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
## for two-sided hypotheses, the value tested against lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<p>Here is some code to plot the posterior student model estimates for each individual subject:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-1" aria-hidden="true" tabindex="-1"></a>ADS_data <span class="ot">&lt;-</span> <span class="fu">spread_rvars</span>(Articulation_student_m3, r_Subject[r_Subject, Intercept], b_Intercept, b_RegisterIDS) <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Subject_estimate =</span> r_Subject <span class="sc">+</span> b_Intercept) <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="fu">replace</span>(Intercept, Intercept <span class="sc">==</span> <span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;ADS&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb95-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="fu">replace</span>(Intercept, Intercept <span class="sc">==</span> <span class="st">&quot;RegisterIDS&quot;</span>, <span class="st">&quot;IDS&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb95-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Intercept <span class="sc">==</span> <span class="st">&quot;ADS&quot;</span>)</span>
<span id="cb95-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-6" aria-hidden="true" tabindex="-1"></a>IDS_data <span class="ot">&lt;-</span> <span class="fu">spread_rvars</span>(Articulation_student_m3, r_Subject[r_Subject, Intercept], b_Intercept, b_RegisterIDS) <span class="sc">%&gt;%</span></span>
<span id="cb95-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Subject_estimate =</span> r_Subject <span class="sc">+</span> b_RegisterIDS) <span class="sc">%&gt;%</span></span>
<span id="cb95-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="fu">replace</span>(Intercept, Intercept <span class="sc">==</span> <span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;ADS&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb95-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="fu">replace</span>(Intercept, Intercept <span class="sc">==</span> <span class="st">&quot;RegisterIDS&quot;</span>, <span class="st">&quot;IDS&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb95-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Intercept <span class="sc">==</span> <span class="st">&quot;IDS&quot;</span>)</span>
<span id="cb95-11"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-11" aria-hidden="true" tabindex="-1"></a>posterior_data_plot <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ADS_data, IDS_data) <span class="sc">%&gt;%</span></span>
<span id="cb95-12"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(Subject_estimate) <span class="sc">%&gt;%</span></span>
<span id="cb95-13"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Subject =</span> <span class="fu">rep</span>(<span class="fu">unique</span>(d<span class="sc">$</span>Subject), <span class="dv">2</span>))</span>
<span id="cb95-14"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-14" aria-hidden="true" tabindex="-1"></a>student_model_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb95-15"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Intercept, <span class="at">y =</span> Subject_estimate), <span class="at">data =</span> posterior_data_plot, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, ) <span class="sc">+</span></span>
<span id="cb95-16"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Intercept, <span class="at">y =</span> Subject_estimate, <span class="at">color =</span> Subject), <span class="at">data =</span> posterior_data_plot, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb95-17"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> Intercept, <span class="at">y =</span> Subject_estimate, <span class="at">color =</span> Subject, <span class="at">group =</span> Subject), <span class="at">data =</span> posterior_data_plot, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb95-18"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb95-19"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.75</span>, <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb95-20"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Speech Style&#39;</span>) <span class="sc">+</span> </span>
<span id="cb95-21"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Effect Size&#39;</span>) <span class="sc">+</span></span>
<span id="cb95-22"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Student Model&#39;</span>) <span class="sc">+</span></span>
<span id="cb95-23"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">viridis</span>(<span class="at">n =</span> <span class="dv">27</span>)) <span class="sc">+</span> </span>
<span id="cb95-24"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">15</span>), </span>
<span id="cb95-25"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb95-26"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb95-27"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb95-28"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb95-29"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb95-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>))</span></code></pre></div>
<p>Let’s compare these estimates with the multi-level Gaussian model:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-1" aria-hidden="true" tabindex="-1"></a>ADS_data <span class="ot">&lt;-</span> <span class="fu">spread_rvars</span>(Articulation_m3, r_Subject[r_Subject, Intercept], b_Intercept, b_RegisterIDS) <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Subject_estimate =</span> r_Subject <span class="sc">+</span> b_Intercept) <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="fu">replace</span>(Intercept, Intercept <span class="sc">==</span> <span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;ADS&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="fu">replace</span>(Intercept, Intercept <span class="sc">==</span> <span class="st">&quot;RegisterIDS&quot;</span>, <span class="st">&quot;IDS&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb96-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Intercept <span class="sc">==</span> <span class="st">&quot;ADS&quot;</span>)</span>
<span id="cb96-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-6" aria-hidden="true" tabindex="-1"></a>IDS_data <span class="ot">&lt;-</span> <span class="fu">spread_rvars</span>(Articulation_m3, r_Subject[r_Subject, Intercept], b_Intercept, b_RegisterIDS) <span class="sc">%&gt;%</span></span>
<span id="cb96-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Subject_estimate =</span> r_Subject <span class="sc">+</span> b_RegisterIDS) <span class="sc">%&gt;%</span></span>
<span id="cb96-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="fu">replace</span>(Intercept, Intercept <span class="sc">==</span> <span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;ADS&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb96-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intercept =</span> <span class="fu">replace</span>(Intercept, Intercept <span class="sc">==</span> <span class="st">&quot;RegisterIDS&quot;</span>, <span class="st">&quot;IDS&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb96-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Intercept <span class="sc">==</span> <span class="st">&quot;IDS&quot;</span>)</span>
<span id="cb96-11"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-11" aria-hidden="true" tabindex="-1"></a>posterior_data_plot <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ADS_data, IDS_data) <span class="sc">%&gt;%</span></span>
<span id="cb96-12"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median_qi</span>(Subject_estimate) <span class="sc">%&gt;%</span></span>
<span id="cb96-13"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Subject =</span> <span class="fu">rep</span>(<span class="fu">unique</span>(d<span class="sc">$</span>Subject), <span class="dv">2</span>))</span>
<span id="cb96-14"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-14" aria-hidden="true" tabindex="-1"></a>gaussian_model_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb96-15"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Intercept, <span class="at">y =</span> Subject_estimate), <span class="at">data =</span> posterior_data_plot, <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, ) <span class="sc">+</span></span>
<span id="cb96-16"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Intercept, <span class="at">y =</span> Subject_estimate, <span class="at">color =</span> Subject), <span class="at">data =</span> posterior_data_plot, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb96-17"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> Intercept, <span class="at">y =</span> Subject_estimate, <span class="at">color =</span> Subject, <span class="at">group =</span> Subject), <span class="at">data =</span> posterior_data_plot, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb96-18"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb96-19"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.75</span>, <span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb96-20"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Speech Style&#39;</span>) <span class="sc">+</span> </span>
<span id="cb96-21"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Effect Size&#39;</span>) <span class="sc">+</span></span>
<span id="cb96-22"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;Gaussian Model&#39;</span>) <span class="sc">+</span></span>
<span id="cb96-23"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">viridis</span>(<span class="at">n =</span> <span class="dv">27</span>)) <span class="sc">+</span> </span>
<span id="cb96-24"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">15</span>), </span>
<span id="cb96-25"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb96-26"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb96-27"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb96-28"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb96-29"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>))</span>
<span id="cb96-30"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-30" aria-hidden="true" tabindex="-1"></a>comparison_plot <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(gaussian_model_plot, student_model_plot, <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb96-31"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb96-31" aria-hidden="true" tabindex="-1"></a>comparison_plot</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>Q7: How do the individual trajectories differ between the two models? Why do you think we see these differences?</p>
<hr />
<p>Let’s also make an ellipsis plot for the student model:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Now the ellipsis plot</span></span>
<span id="cb97-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Partial pooling</span></span>
<span id="cb97-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-3" aria-hidden="true" tabindex="-1"></a>df_partial <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb97-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Subject =</span> <span class="fu">rownames</span>(<span class="fu">coef</span>(Articulation_student_m3)[[<span class="st">&quot;Subject&quot;</span>]][,,<span class="st">&quot;Intercept&quot;</span>]),</span>
<span id="cb97-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ADS =</span> <span class="fu">coef</span>(Articulation_student_m3)[[<span class="st">&quot;Subject&quot;</span>]][,,<span class="st">&quot;Intercept&quot;</span>][,<span class="dv">1</span>],</span>
<span id="cb97-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">RegisterIDS =</span> <span class="fu">coef</span>(Articulation_student_m3)[[<span class="st">&quot;Subject&quot;</span>]][,,<span class="st">&quot;RegisterIDS&quot;</span>][,<span class="dv">1</span>],</span>
<span id="cb97-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type =</span> <span class="st">&quot;Partial pooling&quot;</span></span>
<span id="cb97-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb97-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Original data</span></span>
<span id="cb97-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-10" aria-hidden="true" tabindex="-1"></a>df_no <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb97-11"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="fu">unique</span>(d<span class="sc">$</span>Subject)){</span>
<span id="cb97-12"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-12" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb97-13"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Subject =</span> s,</span>
<span id="cb97-14"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ADS =</span> d<span class="sc">$</span>ArticulationS[d<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;ADS&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>Subject<span class="sc">==</span>s],</span>
<span id="cb97-15"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">RegisterIDS =</span> d<span class="sc">$</span>ArticulationS[d<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;IDS&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>Subject<span class="sc">==</span>s] <span class="sc">-</span> d<span class="sc">$</span>ArticulationS[d<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;ADS&quot;</span> <span class="sc">&amp;</span> d<span class="sc">$</span>Subject<span class="sc">==</span>s],</span>
<span id="cb97-16"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Type =</span> <span class="st">&quot;No pooling&quot;</span></span>
<span id="cb97-17"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb97-18"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">exists</span>(<span class="st">&quot;df_no&quot;</span>)){df_no <span class="ot">=</span> <span class="fu">rbind</span>(df_no, tmp)} <span class="cf">else</span> {df_no <span class="ot">=</span> tmp}</span>
<span id="cb97-19"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-20"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-20" aria-hidden="true" tabindex="-1"></a>df_total <span class="ot">&lt;-</span> df_no[,<span class="fu">c</span>(<span class="st">&quot;Subject&quot;</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb97-21"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb97-22"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ADS =</span> <span class="fu">mean</span>(d<span class="sc">$</span>ArticulationS[d<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;ADS&quot;</span>]),</span>
<span id="cb97-23"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">RegisterIDS =</span>  <span class="fu">mean</span>(d<span class="sc">$</span>ArticulationS[d<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;IDS&quot;</span>]) <span class="sc">-</span> <span class="fu">mean</span>(d<span class="sc">$</span>ArticulationS[d<span class="sc">$</span>Register<span class="sc">==</span><span class="st">&quot;ADS&quot;</span>]),</span>
<span id="cb97-24"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Type =</span> <span class="st">&quot;Total pooling&quot;</span></span>
<span id="cb97-25"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb97-26"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-26" aria-hidden="true" tabindex="-1"></a>df_fixef <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb97-27"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type =</span> <span class="st">&quot;Partial pooling (average)&quot;</span>,</span>
<span id="cb97-28"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">ADS =</span> <span class="fu">fixef</span>(Articulation_student_m3)[<span class="dv">1</span>],</span>
<span id="cb97-29"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">RegisterIDS =</span> <span class="fu">fixef</span>(Articulation_student_m3)[<span class="dv">2</span>]</span>
<span id="cb97-30"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb97-31"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete pooling / fixed effects are center of gravity in the plot</span></span>
<span id="cb97-32"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-32" aria-hidden="true" tabindex="-1"></a>df_gravity <span class="ot">&lt;-</span> df_total <span class="sc">%&gt;%</span> </span>
<span id="cb97-33"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Type, ADS, RegisterIDS) <span class="sc">%&gt;%</span> </span>
<span id="cb97-34"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(df_fixef)</span>
<span id="cb97-35"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb97-35" aria-hidden="true" tabindex="-1"></a>df_gravity</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##         ADS RegisterIDS Type                     
##       &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;                    
## 1  1.83e-16      -0.691 Total pooling            
## 2 -1.34e- 1      -0.388 Partial pooling (average)</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb99-1" aria-hidden="true" tabindex="-1"></a>df_pulled <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(df_no, df_partial)</span>
<span id="cb99-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the variance covariance matrix</span></span>
<span id="cb99-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb99-3" aria-hidden="true" tabindex="-1"></a>cov_mat_t <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(Articulation_student_m3)[[<span class="st">&quot;Subject&quot;</span>]]<span class="sc">$</span>cov</span>
<span id="cb99-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb99-4" aria-hidden="true" tabindex="-1"></a>cov_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb99-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb99-5" aria-hidden="true" tabindex="-1"></a>cov_mat[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span>cov_mat_t[,,<span class="st">&quot;Intercept&quot;</span>][<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb99-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb99-6" aria-hidden="true" tabindex="-1"></a>cov_mat[<span class="dv">2</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span>cov_mat_t[,,<span class="st">&quot;RegisterIDS&quot;</span>][<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb99-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb99-7" aria-hidden="true" tabindex="-1"></a>cov_mat[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span>cov_mat_t[,,<span class="st">&quot;Intercept&quot;</span>][<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb99-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb99-8" aria-hidden="true" tabindex="-1"></a>cov_mat[<span class="dv">2</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span>cov_mat_t[,,<span class="st">&quot;RegisterIDS&quot;</span>][<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb99-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb99-9" aria-hidden="true" tabindex="-1"></a>cov_mat</span></code></pre></div>
<pre><code>##             [,1]        [,2]
## [1,]  0.23373725 -0.03978625
## [2,] -0.03978625  0.29412976</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-1" aria-hidden="true" tabindex="-1"></a>make_ellipse <span class="ot">&lt;-</span> <span class="cf">function</span>(cov_mat, center, level) {</span>
<span id="cb101-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ellipse</span>(cov_mat, <span class="at">centre =</span> center, <span class="at">level =</span> level) <span class="sc">%&gt;%</span></span>
<span id="cb101-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb101-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">level =</span> level) <span class="sc">%&gt;%</span> </span>
<span id="cb101-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>()</span>
<span id="cb101-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-7" aria-hidden="true" tabindex="-1"></a>center <span class="ot">&lt;-</span> <span class="fu">fixef</span>(Articulation_student_m3)</span>
<span id="cb101-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-8" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">3</span>, .<span class="dv">5</span>, .<span class="dv">7</span>, .<span class="dv">9</span>)</span>
<span id="cb101-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an ellipse dataframe for each of the levels defined </span></span>
<span id="cb101-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="co"># above and combine them</span></span>
<span id="cb101-11"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-11" aria-hidden="true" tabindex="-1"></a>df_ellipse <span class="ot">&lt;-</span> levels <span class="sc">%&gt;%</span></span>
<span id="cb101-12"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-12" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_df</span>(<span class="sc">~</span> <span class="fu">make_ellipse</span>(cov_mat, center, <span class="at">level =</span> .x)) <span class="sc">%&gt;%</span> </span>
<span id="cb101-13"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">ADS =</span> x, <span class="at">RegisterIDS =</span> y)</span>
<span id="cb101-14"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb101-14" aria-hidden="true" tabindex="-1"></a>df_ellipse</span></code></pre></div>
<pre><code>## # A tibble: 500 × 3
##          ADS RegisterIDS level
##        &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;
##  1  0.0103        -0.226   0.1
##  2 -0.000638      -0.214   0.1
##  3 -0.0121        -0.203   0.1
##  4 -0.0241        -0.193   0.1
##  5 -0.0366        -0.183   0.1
##  6 -0.0494        -0.175   0.1
##  7 -0.0626        -0.167   0.1
##  8 -0.0761        -0.160   0.1
##  9 -0.0898        -0.154   0.1
## 10 -0.104         -0.149   0.1
## # … with 490 more rows</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-1" aria-hidden="true" tabindex="-1"></a>Student_ellipsis <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_pulled) <span class="sc">+</span> </span>
<span id="cb103-2"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> ADS, <span class="at">y =</span> RegisterIDS, <span class="at">color =</span> Type) <span class="sc">+</span> </span>
<span id="cb103-3"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw contour lines from the distribution of effects</span></span>
<span id="cb103-4"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb103-5"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">group =</span> level, <span class="at">color =</span> <span class="cn">NULL</span>), </span>
<span id="cb103-6"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_ellipse, </span>
<span id="cb103-7"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb103-8"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;grey40&quot;</span></span>
<span id="cb103-9"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb103-10"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_gravity, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb103-11"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb103-12"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb103-13"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">group =</span> Subject, <span class="at">color =</span> <span class="cn">NULL</span>), </span>
<span id="cb103-14"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(.<span class="dv">02</span>, <span class="st">&quot;npc&quot;</span>))</span>
<span id="cb103-15"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb103-16"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use ggrepel to jitter the labels away from the points</span></span>
<span id="cb103-17"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-17" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb103-18"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> Subject, <span class="at">color =</span> <span class="cn">NULL</span>), </span>
<span id="cb103-19"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_no</span>
<span id="cb103-20"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb103-21"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Don&#39;t forget 373</span></span>
<span id="cb103-22"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-22" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb103-23"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> Subject, <span class="at">color =</span> <span class="cn">NULL</span>), </span>
<span id="cb103-24"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_partial</span>
<span id="cb103-25"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb103-26"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Topographic map of regression parameters&quot;</span>) <span class="sc">+</span> </span>
<span id="cb103-27"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Intercept estimate&quot;</span>) <span class="sc">+</span> </span>
<span id="cb103-28"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Slope estimate&quot;</span>) <span class="sc">+</span> </span>
<span id="cb103-29"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb103-30"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb103-31"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb103-32"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb103-33"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb103-34"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb103-35"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb103-36"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb103-37"><a href="part-iv-multi-level-model-with-repeated-measures.html#cb103-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">1.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>))</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="part-iii-linear-regression-with-a-dichotomous-predictor.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="part-v-multi-level-model-based-on-informed-priors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-part2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
